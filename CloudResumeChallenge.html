<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Andrew DeFever | Cloud Resume</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Orbitron:wght@600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>

  <!-- Leaflet core CSS/JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <!-- MarkerCluster & Heatmap plugins -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"/>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>

  <!-- Your theme -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <a class="skip" href="#main">Skip to content</a>

  <nav>
    <div class="nav-inner">
      <div class="brand"><i class="fa-solid fa-cloud"></i><span>Andrew DeFever</span></div>
      <div class="nav-links">
        <a href="#about">About</a>
        <a href="#certs">Certs</a>
        <a href="#skills">Skills</a>
        <a href="#projects">Projects</a>
        <a href="#experience">Experience</a>
        <a href="#education">Education</a>
        <a href="#visitors">Visitors</a>
      </div>
    </div>
  </nav>

  <header class="hero">
    <div class="container">
      <h1 class="title">Cloud Resume Challenge</h1>
      <p class="tag">AWS Certified • Networking & Security • Serverless tinkerer</p>
      <div class="cta">
        <a class="btn" href="mailto:AndrewDeFever@gmail.com"><i class="fa-solid fa-envelope"></i>Email</a>
        <a class="btn" href="https://github.com/AndrewDeFever" target="_blank" rel="noreferrer"><i class="fa-brands fa-github"></i>GitHub</a>
        <a class="btn" href="https://www.linkedin.com/in/andrewdefever/" target="_blank" rel="noreferrer"><i class="fa-brands fa-linkedin"></i>LinkedIn</a>
        <a class="btn external-link" href="./CloudResumeChallenge/Andrew-DeFever-Resume-2025-AWS.pdf" download><i class="fa-solid fa-file-arrow-down"></i>Resume</a>
      </div>
    </div>
  </header>

  <main id="main" class="container">
    <section id="summary" class="card">
      <h2>Professional Summary</h2>
      <p>AWS Certified Cloud Practitioner and CompTIA Security+ certified IT professional with 10+ years of experience in systems analysis, enterprise networking, and infrastructure operations. Proven track record in optimizing network performance, streamlining access control, and leading cross‑functional teams to resolve complex technical issues. Skilled in cloud fundamentals, secure infrastructure management, and multi‑vendor network troubleshooting, with a focus on delivering scalable, resilient, and reliable solutions in fast‑paced environments.</p>

      <figure style="margin:1rem 0 0;">
        <img src="architecture.svg" alt="Diagram: User → Route 53 → CloudFront → S3 and CloudFront → API Gateway → Lambda → DynamoDB" style="width:100%;max-width:980px;border:1px solid var(--card-border);border-radius:12px;box-shadow: var(--shadow);display:block;margin-inline:auto;">
        <figcaption class="meta" style="text-align:center;margin-top:.5rem;">Architecture at a glance — served by CloudFront from S3; backend visits logged via API Gateway → Lambda → DynamoDB.</figcaption>
      </figure>
    </section>

    <section id="about" class="card">
      <h2>About This Site</h2>
      <p class="meta">Built for the <strong>Cloud Resume Challenge</strong> to demonstrate cloud deployment, automation, security hardening, and a small serverless app.</p>

      <div class="grid grid-2">
        <div>
          <h3 class="meta" style="margin:.2rem 0 .4rem;">Frontend & DNS</h3>
          <ul>
            <li>Static site on <strong>Amazon S3</strong> served globally through <strong>CloudFront</strong> (HTTPS via <strong>ACM</strong>).</li>
            <li>Public DNS with <strong>Route 53</strong> (apex <em>ALIAS</em> to CloudFront; optional <code>www</code> redirect).</li>
            <li><strong>S3 Intelligent‑Tiering</strong> for assets and <strong>Server Access Logging</strong> to a dedicated logging bucket.</li>
            <li>Automatic <strong>CloudFront invalidations</strong> on deploy for zero‑stale rollouts.</li>
          </ul>

          <h3 class="meta" style="margin:.8rem 0 .4rem;">Serverless Backend</h3>
          <ul>
            <li><strong>API Gateway</strong> → <strong>Lambda (Python)</strong> → <strong>DynamoDB</strong> for visit tracking and geo stats.</li>
            <li><strong>Usage plans & API keys</strong> for rate limiting; CORS locked to site origin.</li>
            <li><strong>CloudWatch</strong> Logs & Metrics for observability and troubleshooting.</li>
          </ul>
        </div>

        <div class="card" style="background:rgba(255,255,255,.04)">
          <h3 class="meta" style="margin:.2rem 0 .4rem;">CI/CD & Security</h3>
          <ul>
            <li><strong>GitHub Actions</strong> with <strong>OIDC</strong> to assume a deploy role — no long‑lived AWS keys.</li>
            <li><strong>Least‑privilege IAM</strong>: scoped policies for S3 sync and CloudFront invalidation; HTTPS enforced end‑to‑end.</li>
            <li>Optional encryption via <strong>KMS (SSE‑KMS)</strong> on logs/artifacts where applicable.</li>
          </ul>

          <h3 class="meta" style="margin:.8rem 0 .4rem;">UI Features</h3>
          <ul>
            <li>Interactive visitor map using <strong>Leaflet</strong> with marker clustering and heat overlay.</li>
            <li>Recent visitor list with country flags and ISP icons; total visit count.</li>
          </ul>
          <div style="margin-top:.6rem;">
            <a class="btn external-link" href="https://github.com/AndrewDeFever/CloudResumeChallenge" target="_blank" rel="noreferrer">
              <i class="fa-brands fa-github"></i> View GitHub Repo
            </a>
          </div>
        </div>
      </div>
    </section>

    <section id="certs" class="card">
      <h2>Certifications</h2>
      <div class="badges" aria-label="Certification badges">
        <a class="btn external-link" href="./CloudResumeChallenge/AWS-Certified-Cloud-Practitioner-certificate.pdf" target="_blank" rel="noreferrer">
          <i class="fa-brands fa-aws"></i> AWS Cloud Practitioner (Certificate)
        </a>
        <a class="btn external-link" href="./CloudResumeChallenge/CompTIA-Security-plus-Certification.pdf" target="_blank" rel="noreferrer">
          <i class="fa-solid fa-shield"></i> CompTIA Security+ (Certificate)
        </a>
      </div>
      <ul>
        <li>AWS Certified Cloud Practitioner — Jul 2025</li>
        <li>CompTIA Security+ (SY0-701) — Jun 2025</li>
      </ul>
    </section>

    <section id="skills" class="card">
      <h2>Technical Skills</h2>
      <ul>
        <li><strong>AWS:</strong> S3 (Static Hosting, Intelligent‑Tiering, Server Access Logging), CloudFront (TLS, invalidations), Route 53, ACM, IAM (least‑privilege + roles for OIDC), API Gateway (usage plans/rate limiting), Lambda, DynamoDB, CloudWatch, KMS (SSE‑KMS), GitHub Actions OIDC</li>
        <li><strong>Networking:</strong> IP/Ethernet, BGP, MPLS, IPVPN, E‑Line, VPLS, VLANs, firewall policy, DNS (BIND)</li>
        <li><strong>Systems:</strong> Linux CLI, sysadmin, SNMP monitoring, Netcool, Cacti, SolarWinds, Infinera, Cisco IOS/NX‑OS, JunOS</li>
        <li><strong>Security:</strong> Security+; DDoS mitigation (RADware), IAM best practices, secure routing via GRE tunneling</li>
      </ul>
    </section>

    <section id="projects" class="card">
      <h2>Projects</h2>
      <ul>
        <li><strong>Cloud Resume Challenge</strong> — S3 + CloudFront resume site; visitor tracker via API Gateway, Lambda (Python), DynamoDB; rate‑limited API; GitHub Actions OIDC deploys.</li>
      </ul>
    </section>

    <section id="experience" class="card">
      <h2>Experience</h2>
      <!-- Keep your experience bullets here (unchanged) -->
    </section>

    <section id="education" class="card">
      <h2>Education</h2>
      <ul>
        <li><strong>Bachelor’s in Psychology</strong>, Minor in Philosophy — May 2012</li>
      </ul>
    </section>

    <div class="divider"></div>

    <section id="visitors" class="grid grid-2">
      <div class="card">
        <h2>Visitor Map</h2>
        <div id="map" role="img" aria-label="World map of recent visitors"></div>
      </div>
      <div class="card">
        <h2>Recent Visitors</h2>
        <p id="visit-count" class="meta">Visits: loading…</p>
        <ul id="visitor-list" aria-live="polite"></ul>
      </div>
    </section>
  </main>

  <footer class="container">
    <div>© <span id="y"></span> Andrew DeFever — Built on AWS. Be nice to S3 and it’ll be nice to you.</div>
  </footer>

  <!-- Log visit -->
  <script>
    fetch("https://njx3tbb522.execute-api.us-east-1.amazonaws.com/track", { method: "POST" });
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>

  <!-- Map + clustering + heat + legend (with sizing fix) -->
  <script>
    // Canvas2D tweak for some browsers
    (function() {
      const orig = HTMLCanvasElement.prototype.getContext;
      HTMLCanvasElement.prototype.getContext = function(type, opts) {
        if (type === '2d') return orig.call(this, '2d', { willReadFrequently: true });
        return orig.call(this, type, opts);
      };
    })();

    const API_URL = "https://lkqaj47w3b.execute-api.us-east-1.amazonaws.com/ReadGeoCoords";

    function getFlagEmoji(cc){ if(!cc) return "🌐"; return [...cc.toUpperCase()].map(c=>String.fromCodePoint(127397+c.charCodeAt())).join("") }
    const ispIconMap = { "Google":"fab fa-google", "Cox":"fas fa-globe-americas" };
    const getISPIcon = org => (Object.keys(ispIconMap).find(k => (org||"").includes(k)) ? `<i class="${ispIconMap[Object.keys(ispIconMap).find(k => (org||"").includes(k))]}"></i>` : '<i class="fas fa-globe"></i>');

    // Wait until #map has a real size
    const whenMapSized = el => new Promise(res => {
      const ok = () => el.clientWidth > 0 && el.clientHeight > 0;
      if (ok()) return res();
      const ro = new ResizeObserver(() => { if (ok()) { ro.disconnect(); res(); } });
      ro.observe(el);
      setTimeout(() => { if (ok()) { try{ro.disconnect();}catch{} res(); } }, 800);
    });

    fetch(API_URL).then(r => r.json()).then(async data => {
      if (!Array.isArray(data)) throw new Error("Bad payload");

      document.getElementById("visit-count").textContent = `Visits: ${data.length}`;
      data.sort((a,b) => new Date(b.timestamp) - new Date(a.timestamp));

      const listEl = document.getElementById("visitor-list");
      listEl.innerHTML = "";
      data.slice(0,6).forEach(v => {
        const li = document.createElement("li");
        li.innerHTML = `${getFlagEmoji(v.country)} <strong>${v.city}, ${v.region}</strong> — ${getISPIcon(v.org)} <em>${v.org}</em>`;
        listEl.appendChild(li);
      });

      const mapEl = document.getElementById("map");
      await whenMapSized(mapEl);

      const map = L.map(mapEl, { preferCanvas:true }).setView([20,0], 2);
      L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png", {
        attribution: "© CARTO & © OpenStreetMap contributors", maxZoom: 18
      }).addTo(map);

      const markers = L.markerClusterGroup();
      const heatData = [];
      data.forEach(v => {
        const latlng = [v.lat, v.lng];
        markers.addLayer(L.marker(latlng).bindPopup(`<strong>${v.city}</strong><br>${v.org}<br>${v.timestamp}`));
        heatData.push([...latlng, 0.5]);
      });

      map.addLayer(markers);

      map.whenReady(() => {
        try { L.heatLayer(heatData, { radius:25 }).addTo(map); }
        catch(e){ console.warn("Heat layer skipped:", e); }
        setTimeout(() => map.invalidateSize(), 0);
      });

      if (data.length) {
        map.fitBounds(L.latLngBounds(data.map(d => [d.lat, d.lng])), { padding: [40, 40] });
      }

      const legend = L.control({ position:'bottomright' });
      legend.onAdd = () => {
        const div = L.DomUtil.create('div','legend');
        div.innerHTML = `<strong>Legend</strong><br>
          <span style="background:#3388ff;border-radius:50%;"></span> Visitors<br>
          <span style="background:rgba(255,0,0,0.5);"></span> Heat intensity`;
        return div;
      };
      legend.addTo(map);
    }).catch(err => {
      console.error("ReadGeoCoords error:", err);
      document.getElementById("visit-count").textContent = "Visits: unavailable";
    });
  </script>

  <!-- A11y tooltips (single bubble for all .tooltip elements) -->
  <script>
    (function(){
      const bubble = Object.assign(document.createElement('div'), { id: 'tooltip-bubble' });
      document.body.appendChild(bubble);

      function showTip(el){
        bubble.classList.remove('visible');
        const text = el.getAttribute('data-tip') || el.getAttribute('aria-label');
        if(!text) return;
        bubble.textContent = text;
        bubble.style.display = 'block';
        const rect = el.getBoundingClientRect();
        const padding = 10;
        const bubbleRect = bubble.getBoundingClientRect();
        let top = rect.top - bubbleRect.height - padding;
        let left = rect.left + (rect.width/2) - (bubbleRect.width/2);
        left = Math.max(8, Math.min(left, window.innerWidth - bubbleRect.width - 8));
        top = Math.max(8, top);
        bubble.style.top = top + 'px';
        bubble.style.left = left + 'px';
        requestAnimationFrame(()=>bubble.classList.add('visible'));
      }
      function hideTip(){ bubble.classList.remove('visible'); setTimeout(()=>{ bubble.style.display = 'none'; }, 170); }
      function bind(el){
        el.addEventListener('mouseenter', () => showTip(el));
        el.addEventListener('focus', () => showTip(el));
        el.addEventListener('mouseleave', hideTip);
        el.addEventListener('blur', hideTip);
        el.addEventListener('touchstart', () => { showTip(el); setTimeout(hideTip, 2000); }, {passive:true});
      }
      document.querySelectorAll('.tooltip').forEach(bind);
    })();
  </script>
</body>
</html>
